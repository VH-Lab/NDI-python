import unittest
from ndi.dataset import Dataset
from ndi.session.dir import Dir as SessionDir
import tempfile
import shutil

class TestDatasetBuild(unittest.TestCase):
    def setUp(self):
        self.temp_dir = tempfile.mkdtemp()
        self.session_name = 'mysession'
        self.session = SessionDir(self.session_name, self.temp_dir)
        self.dataset_id = 'test_dataset_id'
        self.dataset_name = 'test_dataset'

    def tearDown(self):
        shutil.rmtree(self.temp_dir)

    def test_dataset_instantiation(self):
        """
        Tests the basic instantiation of a Dataset object, mimicking ndi.unittest.dataset.testDatasetBuild.
        """
        # The Python implementation of Dataset currently only takes a reference argument.
        ds = Dataset(self.dataset_name)

        self.assertIsInstance(ds, Dataset)
        # Verify the reference is set correctly via the session
        self.assertEqual(ds.reference(), self.dataset_name)
        # Verify it has an ID (which is generated by IDO in the Session)
        self.assertIsNotNone(ds.id())

if __name__ == '__main__':
    unittest.main()
